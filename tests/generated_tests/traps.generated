TEST_CASE( "Testing wasm <traps_test_0_wasm>", "[traps_test_0_wasm_tests]" ) {
   auto code = backend_t::read_wasm( traps_test_0_wasm ) );
   backend_t bkend( code );
   bkend.set_wasm_allocator( &wa );

   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i32.div_s", static_cast<uint32_t>(1), static_cast<uint32_t>(0), ), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i32.div_u", static_cast<uint32_t>(1), static_cast<uint32_t>(0), ), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.div_s", static_cast<uint64_t>(1), static_cast<uint64_t>(0), ), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.div_u", static_cast<uint64_t>(1), static_cast<uint64_t>(0), ), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i32.div_s", static_cast<uint32_t>(2147483648), static_cast<uint32_t>(4294967295), ), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.div_s", static_cast<uint64_t>(9223372036854775808), static_cast<uint64_t>(18446744073709551615), ), std::exception);
}

TEST_CASE( "Testing wasm <traps_test_1_wasm>", "[traps_test_1_wasm_tests]" ) {
   auto code = backend_t::read_wasm( traps_test_1_wasm ) );
   backend_t bkend( code );
   bkend.set_wasm_allocator( &wa );

   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i32.rem_s", static_cast<uint32_t>(1), static_cast<uint32_t>(0), ), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i32.rem_u", static_cast<uint32_t>(1), static_cast<uint32_t>(0), ), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.rem_s", static_cast<uint64_t>(1), static_cast<uint64_t>(0), ), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.rem_u", static_cast<uint64_t>(1), static_cast<uint64_t>(0), ), std::exception);
}

TEST_CASE( "Testing wasm <traps_test_2_wasm>", "[traps_test_2_wasm_tests]" ) {
   auto code = backend_t::read_wasm( traps_test_2_wasm ) );
   backend_t bkend( code );
   bkend.set_wasm_allocator( &wa );

   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i32.trunc_f32_s", static_cast<float>(2143289344)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i32.trunc_f32_u", static_cast<float>(2143289344)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i32.trunc_f64_s", static_cast<double>(9221120237041090560)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i32.trunc_f64_u", static_cast<double>(9221120237041090560)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.trunc_f32_s", static_cast<float>(2143289344)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.trunc_f32_u", static_cast<float>(2143289344)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.trunc_f64_s", static_cast<double>(9221120237041090560)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.trunc_f64_u", static_cast<double>(9221120237041090560)), std::exception);
}

TEST_CASE( "Testing wasm <traps_test_3_wasm>", "[traps_test_3_wasm_tests]" ) {
   auto code = backend_t::read_wasm( traps_test_3_wasm ) );
   backend_t bkend( code );
   bkend.set_wasm_allocator( &wa );

   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i32.load", static_cast<uint32_t>(65536)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i32.load16_s", static_cast<uint32_t>(65536)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i32.load16_u", static_cast<uint32_t>(65536)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i32.load8_s", static_cast<uint32_t>(65536)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i32.load8_u", static_cast<uint32_t>(65536)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.load", static_cast<uint32_t>(65536)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.load32_s", static_cast<uint32_t>(65536)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.load32_u", static_cast<uint32_t>(65536)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.load16_s", static_cast<uint32_t>(65536)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.load16_u", static_cast<uint32_t>(65536)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.load8_s", static_cast<uint32_t>(65536)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.i64.load8_u", static_cast<uint32_t>(65536)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.f32.load", static_cast<uint32_t>(65536)), std::exception);
   CHECK_THROWS_AS(bkend(nullptr, "env", "no_dce.f64.load", static_cast<uint32_t>(65536)), std::exception);
}

